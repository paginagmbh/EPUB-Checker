<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="../02_sealed_jar">


	<property name="src.dir" location="../01_eclipse-workspace"/>
	<property name="build.dir" location="../03_ANT-build"/>
	<property name="out.dir" location="${build.dir}/output"/>
	
    <buildnumber file="${build.dir}/buildID_EPUBChecker.txt"/>
	
	<tstamp>
		<format property="current.date" pattern="yyyyMMdd" />
	</tstamp>
	<property name="program.version.date" value="${current.date}" />
	
	
	<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
	
	<property name="program.version.txtNumber" value="1.0.0" />
	<property name="program.version.number" value="1.0.0.${build.number}" />
	<property name="program.version.build" value="${build.number}" />
	<property name="program.version.release" value="beta" />	<!-- "" or "beta" -->
	
	<echo>Version: ${program.version.number}</echo>
	<echo>Build: ${program.version.build}</echo>
	
	<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
	
	
	
	
	<!--this file was created by Eclipse Runnable JAR Export Wizard-->
    <!--ANT 1.7 is required                                        -->
    <jar destfile="./paginaEPUBChecker.jar" filesetmanifest="mergewithoutmain">
        <manifest>
            <attribute name="Main-Class" value="com.paginagmbh.epubchecker.paginaEPUBChecker"/>
            <attribute name="Class-Path" value="."/>
        </manifest>
        <fileset dir="${src.dir}/bin"/>
        <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/AppleJavaExtensions.jar"/>
        <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/json-rpc-1.0.jar"/>
        <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/commons-compress-1.2.jar"/>
        <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/cssparser-0.9.6.jar"/>
        <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/jing.jar"/>
        <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/sac-1.3.jar"/>
        <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/saxon9he.jar"/>
        <!-- <zipfileset excludes="META-INF/*.SF" src="${src.dir}/lib/jna.jar"/> -->
    </jar>
	
	

	
	
	
	
	<property name="resources.dir" location="${build.dir}/resources" />
	<property name="jarbundler.dir" location="${build.dir}/libs/jarbundler-2.2.0" />
	
	<taskdef name="jarbundler"
		classname="net.sourceforge.jarbundler.JarBundler"
		classpath="${jarbundler.dir}/jarbundler-2.2.0.jar" />
	
	<jarbundler
		dir="${out.dir}"
		name="EPUB-Checker"
		shortname="EPUB-Checker"
		aboutmenuname="pagina EPUB-Checker"
		bundleid="com.paginagmbh.epubchecker"
		mainclass="com.paginagmbh.epubchecker.paginaEPUBChecker"
		stubfile="${resources.dir}/JavaApplicationStub"
		icon="${resources.dir}/paginaEPUBChecker_512.icns"
		version="${program.version.txtNumber}"
		developmentregion="German"
		signature="PAEC"
		build="${program.version.build}"
		jvmversion="1.6+">
		
		<!-- this documenttype lets me received drag/drop events from safari to my dock icon -->
		<!-- http://informagen.com/JarBundler/DocumentType.html -->
		<documenttype
			name="EPUB files"
			extensions="epub EPUB"
			role="Viewer"/>
		
		<jarfileset dir=".">
			<include name="paginaEPUBChecker.jar" />
		</jarfileset>
	
	</jarbundler>
	
	
	<zip destfile="${out.dir}/pagina-EPUB-Checker_Mac-${program.version.txtNumber}${program.version.release}.zip">
		<zipfileset dir="${out.dir}/EPUB-Checker.app/" filemode="777" prefix="EPUB-Checker.app"/>
	</zip>
	
	
	
	
	
	<property name="launch4j.dir" location="${build.dir}/libs/launch4j" />
	<property name="launch4j.config.dir" location="${build.dir}/config/launch4j" />
	
	<taskdef name="launch4j"
	    classname="net.sf.launch4j.ant.Launch4jTask"
	    classpath="${launch4j.dir}/launch4j.jar:${launch4j.dir}/lib/xstream.jar"
	/>
	
	<launch4j
		configFile="${launch4j.config.dir}/paginaEPUBChecker.xml"
		fileVersion="${program.version.number}"
		txtFileVersion="${program.version.txtNumber}"
		productVersion="${program.version.number}"
		txtProductVersion="${program.version.txtNumber}"
	/>
	
	<zip destfile="${out.dir}/pagina-EPUB-Checker_Win-${program.version.txtNumber}${program.version.release}.zip">
		<zipfileset file="${out.dir}/EPUB-Checker.exe"/>
	</zip>
	
</project>
